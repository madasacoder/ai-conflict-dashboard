<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic Workflow Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .status {
        margin: 10px 0;
        padding: 10px;
        border-radius: 5px;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
      }
    </style>
  </head>
  <body>
    <h1>Basic Workflow Builder Test</h1>

    <div id="status"></div>

    <button onclick="testBasics()">Run Basic Tests</button>
    <button onclick="window.location.href='index.html'">Back to Main App</button>

    <hr />

    <h2>Simple Node Creator</h2>
    <button onclick="addNode()">Add Node</button>
    <div
      id="nodes"
      style="margin-top: 20px; border: 1px solid #ccc; min-height: 200px; padding: 10px"
    >
      <p>Nodes will appear here...</p>
    </div>

    <script>
      function log(message, type = 'info') {
        const status = document.getElementById('status');
        const div = document.createElement('div');
        div.className = 'status ' + type;
        div.textContent = message;
        status.appendChild(div);
      }

      function testBasics() {
        log('Testing JavaScript...', 'info');

        // Test 1: Basic JS
        try {
          const test = () => 'works';
          log('✓ ES6 arrow functions work', 'success');
        } catch (e) {
          log('✗ ES6 not supported: ' + e.message, 'error');
        }

        // Test 2: localStorage
        try {
          localStorage.setItem('test', 'value');
          localStorage.removeItem('test');
          log('✓ localStorage works', 'success');
        } catch (e) {
          log('✗ localStorage error: ' + e.message, 'error');
        }

        // Test 3: Fetch API
        if (typeof fetch !== 'undefined') {
          log('✓ Fetch API available', 'success');
        } else {
          log('✗ Fetch API not available', 'error');
        }

        // Test 4: Backend connection
        fetch('http://localhost:8000/docs')
          .then((res) => {
            if (res.ok) {
              log('✓ Backend API connected', 'success');
            } else {
              log('✗ Backend API error: ' + res.status, 'error');
            }
          })
          .catch((e) => {
            log('✗ Backend API not reachable: ' + e.message, 'error');
          });
      }

      let nodeCount = 0;
      function addNode() {
        nodeCount++;
        const nodesDiv = document.getElementById('nodes');

        if (nodeCount === 1) {
          nodesDiv.innerHTML = ''; // Clear initial message
        }

        const node = document.createElement('div');
        node.style.cssText =
          'display: inline-block; margin: 10px; padding: 10px; border: 2px solid #007bff; border-radius: 5px; background: #e7f3ff;';
        node.innerHTML = `
                <strong>Node ${nodeCount}</strong><br>
                <small>Click to select</small>
            `;
        node.onclick = function () {
          document
            .querySelectorAll('#nodes > div')
            .forEach((n) => (n.style.borderColor = '#007bff'));
          this.style.borderColor = '#28a745';
          log('Selected Node ' + nodeCount, 'info');
        };

        nodesDiv.appendChild(node);
        log('Added Node ' + nodeCount, 'success');
      }

      // Run tests on load
      window.onload = function () {
        log('Page loaded successfully', 'success');
      };
    </script>
  </body>
</html>
